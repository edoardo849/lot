Lambda of Thrones
=====

[High-Concept](https://en.wikipedia.org/wiki/High-concept) GOT story plot generator written for Apex-Lambda.

# Introduction
Ever wanted to have Game of Thrones story plots being randomly generated by a Lambda set of functions? No? Well, that's too bad... this compelling need actually comes from a little experiment trying to answer 2 questions:

1. Is it possible to have a coherent strategy for logging and monitoring Lambda functions?
1. Is it possible to chain Lambda functions in the Terminal to provide a UNIX-like piping?

Both answers turned out to be yes.

# Requirements
For this project to work you'll need to:
1. have [Apex](http://apex.run/) installed on your local machine
1. have an [AWS account](https://console.aws.amazon.com) with full access to:
  - IAM roles
  - Lambda functions
  - CloudWatch
1. have [GoLang](https://golang.org/doc/install) installed on your local machine
1. have [AWS CLI](https://aws.amazon.com/cli/) tools installed on your local machine with valid `~/.aws/config` and `~/.aws/credentials` files

## Recommended modules
Optionally, if you want to see your logs in [ELK](https://www.elastic.co/products) :
1. have an AWS account with further full access to:
  - AWS ElasticSearch
1. have [Sense Chrome extension](https://chrome.google.com/webstore/detail/sense-beta/lhjgkmllcaadmopgmanpapmpjgmfcfig?hl=en) installed

# Installation
> Git clone yada yada

From **within** your `GOPATH`:
```bash
# create the
mkdir $GOPATH/src/github.com/edoardo849 && cd "$_"
# clone the repo
git clone https://github.com/edoardo849/lot

# enter the folder
cd lot
```

## Configuration
Initialise Apex
```bash
# set your default profile for AWS and AWS region
source ./config

apex init

# Project name
Project name: lot

# Project description
Project description: Logging of Thrones
```

I always find useful to setup the aws profile in the project.json file that apex will generate:

```json
file: ./project.json
{
  "profile":"default",
}
```

you may still need to source the ./config file for every new bash session though: that's a known bug in apex.

# Running the functions

As a shorthand I've set up a `Makefile` that takes care of everything. If you want to tweak the configuration have a look at it

```bash
# run the tests
make test

# deploy the code on AWS Lambda
make deploy

# invoke the functions
make plot
```

## Under the hood
TODO
